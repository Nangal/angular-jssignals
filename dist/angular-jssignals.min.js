/*!
 * angular-jssignals v0.1.1
 * 
 * Copyright 2015 Joao Carvalho <jmmtcarvalho@gmail.com>; Licensed MIT
 */

!function(global,factory){"use strict";if("function"==typeof define&&define.amd)define(["signals"],function(signals){factory(global.angular,signals)});else if("object"==typeof exports){var angular=global.angular||window&&window.angular;module.exports=factory(angular,require("signals"))}else factory(global.angular,global.signals)}(this,function(angular,signals){"use strict";function SignalsServiceProvider(Signals){function SignalsServiceFactory(){function extendOptions(options){return angular.extend({listenerContext:void 0,priority:void 0},options||{})}function EventSignal(key){this.key=key}function SignalsService(){Object.defineProperty(this,"SIGNALS",{enumerable:!0,configurable:!1,writable:!1,value:EnumSignals}),this.register=function(key){return register.call(this,key)},this.emit=function(key,data){register.call(this,key)&&this[key].emit(data)},this.listen=function(key,callback,options){return register.call(this,key)?this[key].listen(callback,options):void 0},this.unlisten=function(key,callback,options){return this[key].unlisten(callback,options)},this.unlistenAll=function(key){return this[key].unlistenAll()},this.isListening=function(key,callback,options){return this[key].isListening(callback,options)},this.getNumListeners=function(key){return this[key]?this[key].getNumListeners():0},this.dispose=function(key){this[key].dispose()},this.forget=function(key){this[key].forget()},this.get=function(key){return this[key].get()}}function isValidSignal(key){if(!/^[a-zA-Z0-9_$]+$/.test(key))return!1;for(var k in EnumSignals)if(EnumSignals.hasOwnProperty(k)&&"string"==typeof key&&EnumSignals[k]===key)return!0;return!1}function register(key){if(!isValidSignal(key))return!1;if(_oSignals[key])return!0;if(_oSignals[key]||(_oSignals[key]=new Signals),this[key])return!0;Object.defineProperty(this,key,{value:new EventSignal(key),enumerable:!0,configurable:!1,writable:!1});for(var prop in this[key])Object.defineProperty(this[key],prop,{enumerable:!0,configurable:!1,writable:!1,value:this[key][prop]});return!0}var _oSignals={};EventSignal.prototype.emit=function(data){_oSignals[this.key]&&_oSignals[this.key].dispatch(data)},EventSignal.prototype.listen=function(callback,options){return _oSignals[this.key]?(options=extendOptions(options),options.method=options.addOnce===!0?"addOnce":"add",_oSignals[this.key][options.method](callback,options.listenerContext,options.priority)):void 0},EventSignal.prototype.unlisten=function(callback,options){return _oSignals[this.key]?(options=extendOptions(options),_oSignals[this.key].remove(callback,options.listenerContext)):void 0},EventSignal.prototype.unlistenAll=function(){_oSignals[this.key]&&_oSignals[this.key].removeAll()},EventSignal.prototype.isListening=function(callback,options){return _oSignals[this.key]?(options=extendOptions(options),_oSignals[this.key].has(callback,options.listenerContext)):!1},EventSignal.prototype.getNumListeners=function(){return _oSignals[this.key]?_oSignals[this.key].getNumListeners():0},EventSignal.prototype.dispose=function(){_oSignals[this.key]&&(_oSignals[this.key].dispose(),delete _oSignals[this.key])},EventSignal.prototype.forget=function(){_oSignals[this.key]&&_oSignals[this.key].forget()},EventSignal.prototype.get=function(){return _oSignals[this.key]?_oSignals[this.key]:void 0};var theService=new SignalsService;if(initSignals)for(var k in EnumSignals)EnumSignals.hasOwnProperty(k)&&"string"==typeof EnumSignals[k]&&theService.register(EnumSignals[k]);return theService}var EnumSignals={},initSignals=!1;this.config=function(config){config&&(angular.extend(EnumSignals,config.signals||{}),initSignals=config.init||initSignals)},this.$get=function(){return new SignalsServiceFactory}}angular.module("jsSignalsServiceModule",[]).constant("Signals",signals).provider("SignalsService",SignalsServiceProvider),SignalsServiceProvider.$inject=["Signals"]});
